<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app-addon/components/nf-graph.js - Ember-CLI-Ember-DVC</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Ember-CLI-Ember-DVC"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/NfGraph.html">NfGraph</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/ember-cli-ember-dvc.html">ember-cli-ember-dvc</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: app-addon/components/nf-graph.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Ember from &#x27;ember&#x27;;
import { property, observer } from &#x27;../utils/computed-property-helpers&#x27;;

var SCALE_TYPES = {
  &#x27;linear&#x27;: d3.scale.linear,
  &#x27;power&#x27;: function () {
    return d3.scale.pow().exponent(3);
  },
  &#x27;log&#x27;: d3.scale.log,
  &#x27;ordinal&#x27;: d3.scale.ordinal
};

var computedAlias = Ember.computed.alias;
var computedBool = Ember.computed.bool;

var scaleFactoryProperty = function(axis) {
  return property(axis + &#x27;ScaleType&#x27;, function (type) {
    var factory = SCALE_TYPES[type];
    if (!factory) {
      throw new Error(&#x27;invalid scale type: &#x27; + type);
    }
    return factory;
  });
};

var domainProperty = function(axis) {
  return property(
    axis + &#x27;Data&#x27;, axis + &#x27;DomainMode&#x27;, axis + &#x27;Min&#x27;, axis + &#x27;Max&#x27;, axis + &#x27;ScaleType&#x27;,
    function(data, domainMode, min, max, scaleType) {
      var domain = null;

      if(scaleType === &#x27;ordinal&#x27;) {
        this.set(axis + &#x27;Min&#x27;, data[0]);
        this.set(axis + &#x27;Max&#x27;, data[data.length - 1]);
        domain = data;
      } else {
        var extent = [min, max];

        if(domainMode === &#x27;auto&#x27;) {
          extent = d3.extent(data);
          this.set(axis + &#x27;Min&#x27;, extent[0]);
          this.set(axis + &#x27;Max&#x27;, extent[1]);
        }

        if(scaleType === &#x27;log&#x27;) {
          if (extent[0] &lt;= 0) {
            extent[0] = 1;
          }
          if (extent[1] &lt;= 0) {
            extent[1] = 1;
          }
        }

        domain = extent;
      }

      return domain;
    }
  );
};

var scaleProperty = function(axis) {
  return property(
    axis + &#x27;ScaleFactory&#x27;, axis + &#x27;Range&#x27;, axis + &#x27;Domain&#x27;, axis + &#x27;ScaleType&#x27;, axis + &#x27;TickCount&#x27;, axis + &#x27;OrdinalPadding&#x27;, axis + &#x27;OrdinalOuterPadding&#x27;,
    function(scaleFactory, range, domain, scaleType, tickCount, ordinalPadding, ordinalOuterPadding) {
      var scale = scaleFactory();

      if(scaleType === &#x27;ordinal&#x27;) {
        scale = scale.domain(domain).rangeRoundBands(range, ordinalPadding, ordinalOuterPadding);
      } else {        
        scale = scale.domain(domain).range(range);
      }

      return scale;
    }
  );
};

/**
 * A container component for building complex cartesian graphs.
 *
 * @module ember-cli-ember-dvc
 * @class NfGraph
 */
export default Ember.Component.extend({
  /**
   * @property tagName
   * @final
   */
  tagName: &#x27;div&#x27;,  

  /** 
   * allows child compoenents to identify graph parent.
   * @property isGraph
   * @final
   */
  isGraph: true,

  /**
   * @property hasRendered
   * @private
   */
  hasRendered: false,

  /**
   * The width of the graph in pixels.
   * @property width
   * @type Number
   * @default 300
   */
  width: 300,

  /**
   * The height of the graph in pixels.
   * @property height
   * @type Number
   * @default 100
   */
  height: 100,

  /**
   * The padding at the top of the graph
   * @property paddingTop
   * @type Number
   * @default 0
   */
  paddingTop: 0,

  /**
   * The padding at the left of the graph
   * @property paddingLeft
   * @type Number
   * @default 0
   */
  paddingLeft: 0,

  /**
   * The padding at the right of the graph
   * @property paddingRight
   * @type Number
   * @default 0
   */
  paddingRight: 0,

  /**
   * The padding at the bottom of the graph
   * @property paddingBottom
   * @type Number
   * @default 0
   */
  paddingBottom: 0,

  /**
   * Determines whether to display &quot;lanes&quot; in the background of
   * the graph.
   * @property showLanes
   * @type Boolean
   * @default false
   */
  showLanes: false,


  /**
   * The domain mode for the x axis. This determines the behavior of
   * xMin and xMax as they relate to all of the data in the graph and
   * to the domain for scaling purposes.
   *
   * Possible values:
   * - &#x60;&#x27;auto&#x27;&#x60; - automatically sizes the domain to the data it contains
   * - &#x60;&#x27;fixed&#x27;&#x60; - fixes the domain to bounds specified by &#x60;xMin&#x60; and &#x60;xMax&#x60;
   *
   * @property xDomainMode
   * @type String
   * @default &#x27;auto&#x27;
   */
  xDomainMode: &#x27;auto&#x27;,

  /**
   * The domain mode for the y axis. This determines the behavior of
   * &#x60;yMin&#x60; and &#x60;yMax&#x60; as they relate to all of the data in the graph and
   * to the domain for scaling purposes.
   *
   * Possible values:
   * - &#x60;&#x27;auto&#x27;&#x60; - automatically sizes the domain to the data it contains
   * - &#x60;&#x27;fixed&#x27;&#x60; - fixes the domain to bounds specified by &#x60;yMin&#x60; and &#x60;yMax&#x60;
   *
   * @property yDomainMode
   * @type String
   * @default &#x27;auto&#x27;
   */
  yDomainMode: &#x27;auto&#x27;,

  /**
   * The type of scale to use for x values.
   *
   * Possible Values:
   * - &#x60;&#x27;linear&#x27;&#x60; - a standard linear scale
   * - &#x60;&#x27;log&#x27;&#x60; - a logarithmic scale
   * - &#x60;&#x27;power&#x27;&#x60; - a power-based scale (exponent = 3)
   * - &#x60;&#x27;ordinal&#x27;&#x60; - an ordinal scale, used for ordinal data. required for bar graphs.
   * 
   * @property xScaleType
   * @type String
   * @default &#x27;linear&#x27;
   */
  xScaleType: &#x27;linear&#x27;,

  /**
   * The type of scale to use for y values.
   *
   * Possible Values:
   * - &#x60;&#x27;linear&#x27;&#x60; - a standard linear scale
   * - &#x60;&#x27;log&#x27;&#x60; - a logarithmic scale
   * - &#x60;&#x27;power&#x27;&#x60; - a power-based scale (exponent = 3)
   * - &#x60;&#x27;ordinal&#x27;&#x60; - an ordinal scale, used for ordinal data. required for bar graphs.
   * 
   * @property yScaleType
   * @type String
   * @default &#x27;linear&#x27;
   */
  yScaleType: &#x27;linear&#x27;,
  
  xOrdinalPadding: 0.1,
  xOrdinalOuterPadding: 0.1,

  yOrdinalPadding: 0.1,
  yOrdinalOuterPadding: 0.1,

  yAxis: null,
  xAxis: null,

  _xMin: 0,
  _xMax: 1,
  _yMin: 0,
  _yMax: 1,  

  xMin: computedAlias(&#x27;_xMin&#x27;),
  xMax: computedAlias(&#x27;_xMax&#x27;),
  yMin: computedAlias(&#x27;_yMin&#x27;),
  yMax: computedAlias(&#x27;_yMax&#x27;),

  graphics: computedAlias(&#x27;_graphics&#x27;),
  showYAxis: computedBool(&#x27;yAxis&#x27;),
  showXAxis: computedBool(&#x27;xAxis&#x27;),

  _graphicsSortedDataChanged: observer(
    &#x27;graphics.@each.sortedData&#x27;, 
    function(graphics){
      var all = graphics.reduce(function(all, graphic) {
        all = all.concat(graphic.get(&#x27;sortedData&#x27;) || []);
        return all;
      }, []);

      this.set(&#x27;xData&#x27;, all.map(function(d) { return d[0]; }));
      this.set(&#x27;yData&#x27;, all.map(function(d) { return d[1]; }));
    }
  ),

  xScaleFactory: scaleFactoryProperty(&#x27;x&#x27;),
  yScaleFactory: scaleFactoryProperty(&#x27;y&#x27;),

  xDomain: domainProperty(&#x27;x&#x27;),
  yDomain: domainProperty(&#x27;y&#x27;),

  xScale: scaleProperty(&#x27;x&#x27;),
  yScale: scaleProperty(&#x27;y&#x27;),

  // used to register lines, areas, etc.
  registerGraphic: function (graphic) {
    var graphics = this.get(&#x27;graphics&#x27;);
    graphics.pushObject(graphic);
  },

  unregisterGraphic: function(graphic) {
    var graphics = this.get(&#x27;graphics&#x27;);
    graphics.removeObject(graphic);
  },

  _hoverChangeHandlers: property(function(){
    return [];
  }),

  _hoverEndHandlers: property(function(){
    return [];
  }),

  hoverChange: function(handler) {
    this.get(&#x27;_hoverChangeHandlers&#x27;).pushObject(handler);
  },

  hoverEnd: function(handler) {
    this.get(&#x27;_hoverEndHandlers&#x27;).pushObject(handler);
  },
  
  onDidGraphHoverChange: function (e, mouseX, mouseY) {
    var graphics = this.get(&#x27;graphics&#x27;);
    
    if (!graphics) {
      return;
    }

    var data = {
      x: mouseX,
      y: mouseY
    };

    this.get(&#x27;_hoverChangeHandlers&#x27;).forEach(function(handler) {
      handler(e, data);
    });
  },

  onDidGraphHoverEnd: function (e) {
    var graphics = this.get(&#x27;graphics&#x27;);
    if (!graphics) {
      return;
    }

    this.get(&#x27;_hoverEndHandlers&#x27;).forEach(function(handler) {
      handler(e);
    });
  },

  yRange: property(&#x27;graphHeight&#x27;, function (graphHeight) {
    return [graphHeight, 0];
  }),

  xRange: property(&#x27;graphWidth&#x27;, function (graphWidth) {
    return [0, graphWidth];
  }),

  hasData: property(&#x27;graphics&#x27;, function(graphics) {
    return graphics &amp;&amp; graphics.length &gt; 0;
  }),

  graphX: property(
    &#x27;paddingLeft&#x27;, &#x27;yAxis.width&#x27;, &#x27;yAxis.orient&#x27;, 
    function (paddingLeft, yAxisWidth, yAxisOrient) {
      if(yAxisOrient === &#x27;right&#x27;) {
        return paddingLeft;
      }
      return paddingLeft + yAxisWidth;
    }
  ),

  graphY: property(&#x27;paddingTop&#x27;, &#x27;xAxis.orient&#x27;, &#x27;xAxis.height&#x27;, 
    function (paddingTop, xAxisOrient, xAxisHeight) {
      if(xAxisOrient === &#x27;top&#x27;) {
        return xAxisHeight + paddingTop;
      }
      return paddingTop;
    }
  ),

  graphWidth: property(&#x27;width&#x27;, &#x27;paddingRight&#x27;, &#x27;paddingLeft&#x27;, &#x27;yAxis.width&#x27;,
    function (width, paddingLeft, paddingRight, yAxisWidth) {
      paddingRight = paddingRight || 0;
      paddingLeft = paddingLeft || 0;
      yAxisWidth = yAxisWidth || 0;
      return width - paddingRight - paddingLeft - yAxisWidth;
    }
  ),

  graphHeight: property(&#x27;height&#x27;, &#x27;paddingTop&#x27;, &#x27;paddingBottom&#x27;, &#x27;xAxis.height&#x27;,
    function (height, paddingTop, paddingBottom, xAxisHeight) {
      paddingTop = paddingTop || 0;
      paddingBottom = paddingBottom || 0;
      xAxisHeight = xAxisHeight || 0;
      return height - paddingTop - paddingBottom - xAxisHeight;
    }
  ),

  graphTransform: property(&#x27;graphX&#x27;, &#x27;graphY&#x27;, function (graphX, graphY) {
    return &#x27;translate(%@, %@)&#x27;.fmt(graphX, graphY);
  }),

  willInsertElement: function () {
    this.set(&#x27;hasRendered&#x27;, true);
  },

  didInsertElement: function () {
    var graphContentGroup = this.$(&#x27;.nf-graph-content&#x27;);
    var self = this;

    this.set(&#x27;svg&#x27;, this.$(&#x27;svg&#x27;));
    this.set(&#x27;graphContentGroup&#x27;, graphContentGroup);

    graphContentGroup.on(&#x27;mousemove&#x27;, function (e) {
      Ember.run(function () {
        var mouse = self.mousePoint(graphContentGroup[0], e);
        self.onDidGraphHoverChange(e, mouse[0], mouse[1]);
      });
    });

    graphContentGroup.on(&#x27;mouseleave&#x27;, function (e) {
      Ember.run(function () {
        self.onDidGraphHoverEnd(e);
      });
    });
  },

  // gets mouse position relative to the container
  mousePoint: function (container, e) {
    var svg = container.ownerSVGElement || container;
    if (svg.createSVGPoint) {
      var point = svg.createSVGPoint();
      point.x = e.clientX;
      point.y = e.clientY;
      point = point.matrixTransform(container.getScreenCTM().inverse());
      return [ point.x, point.y ];
    }
    var rect = container.getBoundingClientRect();
    return [ e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop ];
  },

  parentController: Ember.computed.alias(&#x27;templateData.view.controller&#x27;),

  _setup: function(){
    this.set(&#x27;graphics&#x27;, []);
  }.on(&#x27;init&#x27;)
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
