<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app-addon/components/nf-table.js - Ember-CLI-Ember-DVC</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Ember-CLI-Ember-DVC"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/components.nf-area.html">components.nf-area</a></li>
            
                <li><a href="../classes/components.nf-area-stack.html">components.nf-area-stack</a></li>
            
                <li><a href="../classes/components.nf-bars.html">components.nf-bars</a></li>
            
                <li><a href="../classes/components.nf-cell.html">components.nf-cell</a></li>
            
                <li><a href="../classes/components.nf-column.html">components.nf-column</a></li>
            
                <li><a href="../classes/components.nf-crosshair.html">components.nf-crosshair</a></li>
            
                <li><a href="../classes/components.nf-dot.html">components.nf-dot</a></li>
            
                <li><a href="../classes/components.nf-gg.html">components.nf-gg</a></li>
            
                <li><a href="../classes/components.nf-graph.html">components.nf-graph</a></li>
            
                <li><a href="../classes/components.nf-graph-content.html">components.nf-graph-content</a></li>
            
                <li><a href="../classes/components.nf-header.html">components.nf-header</a></li>
            
                <li><a href="../classes/components.nf-horizontal-line.html">components.nf-horizontal-line</a></li>
            
                <li><a href="../classes/components.nf-line.html">components.nf-line</a></li>
            
                <li><a href="../classes/components.nf-plot.html">components.nf-plot</a></li>
            
                <li><a href="../classes/components.nf-range-marker.html">components.nf-range-marker</a></li>
            
                <li><a href="../classes/components.nf-range-markers.html">components.nf-range-markers</a></li>
            
                <li><a href="../classes/components.nf-right-tick.html">components.nf-right-tick</a></li>
            
                <li><a href="../classes/components.nf-scroll-area.html">components.nf-scroll-area</a></li>
            
                <li><a href="../classes/components.nf-selection-box.html">components.nf-selection-box</a></li>
            
                <li><a href="../classes/components.nf-svg-image.html">components.nf-svg-image</a></li>
            
                <li><a href="../classes/components.nf-svg-line.html">components.nf-svg-line</a></li>
            
                <li><a href="../classes/components.nf-svg-path.html">components.nf-svg-path</a></li>
            
                <li><a href="../classes/components.nf-svg-rect.html">components.nf-svg-rect</a></li>
            
                <li><a href="../classes/components.nf-table.html">components.nf-table</a></li>
            
                <li><a href="../classes/components.nf-table-group.html">components.nf-table-group</a></li>
            
                <li><a href="../classes/components.nf-vertical-line.html">components.nf-vertical-line</a></li>
            
                <li><a href="../classes/components.nf-x-axis.html">components.nf-x-axis</a></li>
            
                <li><a href="../classes/components.nf-y-axis.html">components.nf-y-axis</a></li>
            
                <li><a href="../classes/components.nf-y-diff.html">components.nf-y-diff</a></li>
            
                <li><a href="../classes/mixins.graph-area-utils.html">mixins.graph-area-utils</a></li>
            
                <li><a href="../classes/mixins.graph-data-graphic.html">mixins.graph-data-graphic</a></li>
            
                <li><a href="../classes/mixins.graph-data-position-utils.html">mixins.graph-data-position-utils</a></li>
            
                <li><a href="../classes/mixins.graph-graphic-with-tracking-dot.html">mixins.graph-graphic-with-tracking-dot</a></li>
            
                <li><a href="../classes/mixins.graph-has-graph-parent.html">mixins.graph-has-graph-parent</a></li>
            
                <li><a href="../classes/mixins.graph-line-utils.html">mixins.graph-line-utils</a></li>
            
                <li><a href="../classes/mixins.graph-registered-graphic.html">mixins.graph-registered-graphic</a></li>
            
                <li><a href="../classes/mixins.graph-requires-scale-source.html">mixins.graph-requires-scale-source</a></li>
            
                <li><a href="../classes/mixins.graph-selectable-graphic.html">mixins.graph-selectable-graphic</a></li>
            
                <li><a href="../classes/mixins.table-column-registrar.html">mixins.table-column-registrar</a></li>
            
                <li><a href="../classes/utils.nf.graph-event.html">utils.nf.graph-event</a></li>
            
                <li><a href="../classes/utils.nf.graph-mouse-event.html">utils.nf.graph-mouse-event</a></li>
            
                <li><a href="../classes/utils.nf.graph-position.html">utils.nf.graph-position</a></li>
            
                <li><a href="../classes/utils.nf.scroll-area-action-context.html">utils.nf.scroll-area-action-context</a></li>
            
                <li><a href="../classes/utils.parse-property-expression.html">utils.parse-property-expression</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/scale-utils.html">scale-utils</a></li>
            
                <li><a href="../modules/utils_nf_array-helpers.html">utils/nf/array-helpers</a></li>
            
                <li><a href="../modules/utils_nf_svg-dom.html">utils/nf/svg-dom</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: app-addon/components/nf-table.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Ember from &#x27;ember&#x27;;
import multiSort from &#x27;../utils/multi-sort&#x27;;
import TableColumnRegistrar from &#x27;../mixins/table-column-registrar&#x27;;
import trackedArrayProperty from &#x27;../utils/nf/tracked-array-property&#x27;;

var get = Ember.get;
var set = Ember.set;

/**
	Composable table component with built-in sorting
	
	### Basic Example

	      {{#nf-table rows=myData}}

	      	{{#nf-column sortField=&quot;foo&quot;}}
	      	  {{nf-header}}
	      	  	&lt;span class=&quot;nf-column-label&quot;&gt;Foo&lt;/span&gt;
	      	  {{/nf-header}}
	      	  {{#nf-cell}}
	      			{{row.foo}}
	      	  {{/nf-cell}}
	      	{{/nf-column}}

	      	{{#nf-column sortField=&quot;foo&quot;}}
	      	  {{nf-header}}
	      	  	&lt;span class=&quot;nf-column-label&quot;&gt;Bar&lt;/span&gt;
	      	  {{/nf-header}}
	      	  {{#nf-cell}}
	      			{{row.bar}}
	      	  {{/nf-cell}}
	      	{{/nf-column}}

	      {{/nf-table}}
	
	The example above will create a sortable table from an array &#x60;myData&#x60; containing objects
	with fields &#x60;foo&#x60; and &#x60;bar&#x60;.

	### Grouped Example

	If you wish to create a &quot;grouped table&quot;, you simply need to group the data with the &#x60;groupBy&#x60;
	property.

	Additionally, you can add grouping rows with the &#x60;{{nf-table-group}}&#x60; component, which allows you
	to define the columns for the group rows. **If you do this, you will need to create an ArrayController**
	for the group that will carry with it any computed properties you might need, such as a sum or average
	aggregated over the group. The array controller for your grouping must be assigned to the &#x60;itemController&#x60;
	property on the &#x60;nf-table-group&#x60; component.

				{{#nf-table rows=myData groupBy=&quot;baz&quot;}}
					
					{{#nf-table-group itemController=&quot;my-group-row&quot;}}

						{{#nf-column}}
							{{#nf-cell colspan=&quot;2&quot;}}
								Baz: {{group.baz}}
								Bars: {{group.barSum}}
							{{/nf-cell}}
						{{/nf-column}}
					
					{{/nf-table-group}}

	      	{{#nf-column sortBy=&quot;foo&quot;}}
	      	  {{nf-header}}
	      	  	&lt;span class=&quot;nf-column-label&quot;&gt;Foo&lt;/span&gt;
	      	  {{/nf-header}}
	      	  {{#nf-cell}}
	      			{{row.foo}}
	      	  {{/nf-cell}}
	      	{{/nf-column}}
	      	
	      	{{#nf-column sortBy=&quot;foo&quot;}}
	      	  {{nf-header}}
	      	  	&lt;span class=&quot;nf-column-label&quot;&gt;Bar&lt;/span&gt;
	      	  {{/nf-header}}
	      	  {{#nf-cell}}
	      			{{row.bar}}
	      	  {{/nf-cell}}
	      	{{/nf-column}}

	      {{/nf-table}}

	Which would need an accompanying array controller definition &#x60;my-group-row&#x60;:

				export default Ember.ArrayController.extend({
					// returns the first value from the array
					baz: function(){
						return this.get(&#x27;model&#x27;)[0].baz;
					}.property(&#x27;model.@each.baz&#x27;),

					//gets the sum of all the bars
					barSum: function() {
						return this.get(&#x27;model&#x27;).reduce(function(sum, item) {
							return sum + item.bar;
						}, 0);
					}.property(&#x27;model.@each.bar&#x27;),
			  });

	### Styling
	
	nf-table emits a &#x60;&lt;table&gt;&#x60; with a class of &#x60;nf-table&#x60; applied to it.


	@namespace components
	@class nf-table
	@extends Ember.Component
	@uses mixins.table-column-registrar
*/
export default Ember.Component.extend(TableColumnRegistrar, {
	tagName: &#x27;div&#x27;,

	/**
		Gets or sets the scroll of the underlying 
		scroll area if there is one.
		@property scrollTop
		@type {Number}
		@default 0
	*/
	scrollTop: 0,

	/**
		Gets or sets the scroll by percentage
		of scrollHeight of the underlying 
		scroll area if there is one.
		@property scrollTopPercentage
		@type {Number}
		@default 0
	*/
	scrollTopPercentage: 0,

	/**
		Property used by child components to locate the table component.
		@property isTable
		@type Boolean
		@default true
	*/
	isTable: true,

	/**
		Gets the nf-table-group component if one is present.
		@property tableGroup
		@type components.nf-table-group
		@default null
	*/
	tableGroup: null,

	/**
		The expression used to locate the values in the rows to group by.
		@property groupBy
		@type String
		@default null
	*/
	groupBy: null,

	/**
		The type of grouping to perform with the groupBy

		# options
		- &#x60;&#x27;flat&#x27;&#x60;: (default) rows data is flattened and groups are aggregated by matching
								the property specified with &#x60;groupBy&#x60;. For example, if &#x60;groupBy=&quot;foo&quot;&#x60; rows
								will be grouped by all rows with a &#x60;foo&#x60; property that matches.
		- &#x60;&#x27;hierarchy&#x27;&#x60;: rows data is already in parent/child format. Parent rows contain child rows on 
								the property specified with &#x60;groupBy&#x60;. For example, if &#x60;groupBy=&quot;children&quot;&#x60;, each row
								in the base rows data array will be a grouping row, and the	array of items under 
								&#x60;children&#x60; will be used as the &quot;child&quot; rows of each group.
		@property groupFrom
		@type String
		@default &#x27;flat&#x27;
	*/
	groupFrom: &#x27;flat&#x27;,

	/**
		Gets or sets whether the table has a scrollable layout.
		@property scrollable
		@type Boolean
		@default false
	*/
	scrollable: false,

	/**
		The name of an item controller for the rows
		@property itemController
		@type {String}
		@default null
	*/
	itemController: null,

	/**
		Gets whether or not to use the grouped table layout
		@property useGroupedTableLayout
		@type Boolean
		@private
		@readonly
	*/
	useGroupedTableLayout: Ember.computed.bool(&#x27;groupBy&#x27;),

	_getArrayController: function(content, ctrlName, itemControllerProp) {
		var CtrlClass = this.container.lookupFactory(&#x27;controller:&#x27; + ctrlName);
		var ctrl = CtrlClass.create({
			content: content,
			table: this
		});
		if(this.get(itemControllerProp)) {
			ctrl.set(&#x27;itemController&#x27;, this.get(itemControllerProp));
		}
		return ctrl;
	},

	getGroupsFromFlattened: function(rows, groupBy) {
		var groups = [];
		var groupsHash = {};
		var groupsCtrl = this._getArrayController(groups, &#x27;nf-table-group-controller&#x27;, &#x27;tableGroup.itemController&#x27;);

		rows.forEach(function(row) {
			var groupKey = get(row, groupBy);
			var rowsCtrl = groupsHash[groupKey];
			if(!rowsCtrl) {
				rowsCtrl = groupsHash[groupKey] = this._getArrayController([], &#x27;nf-table-rows-controller&#x27;, &#x27;itemController&#x27;);
				rowsCtrl.set(&#x27;groupKey&#x27;, groupKey);
				groups.pushObject(rowsCtrl);
			}
			rowsCtrl.get(&#x27;content&#x27;).pushObject(row);
			set(row, &#x27;groupController&#x27;, rowsCtrl);
		}, this);

		groupsCtrl.sortBy(&#x27;groupKey&#x27;);
		return groupsCtrl;
	},

	getGroupsFromHierarchy: function(rows, groupBy) {
		var groups = [];
		var groupsCtrl = this._getArrayController(groups, &#x27;nf-table-group-controller&#x27;, &#x27;tableGroup.itemController&#x27;);

		rows.forEach(function(row) {
			var childRows = get(row, groupBy);
			var childRowsCtrl = this._getArrayController(childRows, &#x27;nf-table-rows-controller&#x27;, &#x27;itemController&#x27;);
			childRows.forEach(function(childRow) {
				childRow.set(&#x27;groupController&#x27;, childRowsCtrl);
			});
			groups.pushObject(childRowsCtrl);
		});

		return groupsCtrl;
	},

	groupsController: function() {
		var rows = this.get(&#x27;rows&#x27;);
		var groupBy = this.get(&#x27;groupBy&#x27;);
		var groupFrom = this.get(&#x27;groupFrom&#x27;);
		if(groupFrom === &#x27;hierarchy&#x27;) {
			return this.getGroupsFromHierarchy(rows, groupBy);
		} else {
			return this.getGroupsFromFlattened(rows, groupBy);
		}
	}.property(&#x27;rows&#x27;, &#x27;groupBy&#x27;, &#x27;groupFrom&#x27;, &#x27;tableGroup.itemController&#x27;, &#x27;itemController&#x27;),

	/**
		Alias for the rowAction on the nf-table-group
		@property groupRowAction
		@type String
		@default null
	*/
	groupRowAction: Ember.computed.alias(&#x27;tableGroup.rowAction&#x27;),

	/**
		The data source for rows to display in this table.
		@property rows
		@default null
	*/
	rows: null,

	classNames: [&#x27;nf-table&#x27;],

	hasRendered: false,

	_hasRendered: function() {
		this.set(&#x27;hasRendered&#x27;, true);
	}.on(&#x27;willInsertElement&#x27;),

	/**
		The property on each row item to track data by. If undefined, will track by index.
		@property trackBy
		@type String
		@default undefined
	*/
	trackBy: undefined,

	rowController: function(){
		var ctrl = this.container.lookup(&#x27;controller:nf-table-rows-controller&#x27;);
		ctrl.set(&#x27;content&#x27;, this.get(&#x27;rows&#x27;));
		ctrl.set(&#x27;table&#x27;, this);
		var itemController = this.get(&#x27;itemController&#x27;);
		if(itemController) {
			ctrl.set(&#x27;itemController&#x27;, itemController);
		}
		return ctrl;
	}.property(&#x27;rows&#x27;, &#x27;itemController&#x27;),

	/**
		The rows to render, tracked by whatever field is listed in teh trackBy property
		@property trackedRows
		@type Array
		@readonly
		@private
	*/
	trackedRows: trackedArrayProperty(&#x27;rowController&#x27;, &#x27;trackBy&#x27;),

	/**
		Triggers the &#x60;willSort&#x60; and &#x60;didSort&#x60; events. Also calls &#x60;doSort&#x60;
		@method onSort
	*/
	onSort: function(){
		this.trigger(&#x27;willSort&#x27;);
		this.doSort();
		this.trigger(&#x27;didSort&#x27;);
	},

	/**
		Performs the sort by reorganizing the DOM. If you want to use some other 
		method of sorting, this is the guy you&#x27;ll need to override.
		@method doSort
	*/
	doSort: function(){
		var sortedRows = this.get(&#x27;sortedRows&#x27;);
		if(Ember.isArray(sortedRows)) {
			if(this.get(&#x27;useGroupedTableLayout&#x27;)) {
				sortedRows.forEach(function(row) {
					var key = get(row, &#x27;__meta__trackedKey&#x27;); //HACK: from tracked-array-property
					var groupKey = get(row, &#x27;groupController.groupKey&#x27;);
					var elem = this.$(&#x27;[data-nf-table-sort-key=&quot;&#x27; + key + &#x27;&quot;]&#x27;);
					var groupElem = this.$(&#x27;[data-nf-table-group-key=&quot;&#x27; + groupKey + &#x27;&quot;]&#x27;);
					elem.detach().insertAfter(groupElem);
				}, this);
			} else {
				sortedRows.forEach(function(row) {
					var key = get(row, &#x27;__meta__trackedKey&#x27;); //HACK: from tracked-array-property
					var elem = this.$(&#x27;[data-nf-table-sort-key=&quot;&#x27; + key + &#x27;&quot;]&#x27;);
					var parent = elem.parent();
					elem.detach().appendTo(parent);
				}, this);
			}
		}
	},

	/**
		Observes changes to column sorts and fires the &#x60;onSort&#x60; method afterRender
		@method observeSortChanges
	*/
	observeSortChanges: function(){
		Ember.run.scheduleOnce(&#x27;afterRender&#x27;, this, this.onSort);
	}.observes(&#x27;_columns.@each.sortDirection&#x27;, &#x27;_columns.@each.sortBy&#x27;),

	/**
		A computed property returning a sorted copy of &#x60;rows&#x60;
		@property sortedRows
		@type Array
		@readonly
	*/
	sortedRows: function(){
		var sortMap = this.get(&#x27;sortMap&#x27;);
		var rowsCopy = this.get(&#x27;trackedRows&#x27;).slice();
		multiSort(rowsCopy, sortMap);
		if(this.get(&#x27;sortedAction&#x27;)) {
			this.sendAction(&#x27;sortedAction&#x27;, rowsCopy);
		}
		return rowsCopy;
	}.property(&#x27;trackedRows.[]&#x27;, &#x27;sortMap&#x27;),

	/**
		A computed alias returning the controller of the current view. Used to wire
		up child templates to the proper controller.
		@property parentController
		@type Ember.Controller
		@readonly
	*/
	parentController: Ember.computed.alias(&#x27;templateData.view.controller&#x27;),

	/**
		The name of the action to fire when a row is clicked.
		Sends an object with the &#x60;row&#x60; and &#x60;table&#x60;.

		For group rows, see {{#crossLink &quot;components.nf-table-group/rowAction:property&quot;}}{{/crossLink}}.
		@property rowAction
		@type String
		@default null
	*/
	rowAction: null,

	/**
		An action to be fired when the rows are sorted.
		Passes the sorted rows (or groups)
		@property sortedAction
		@type String
		@default null
	*/
	sortedAction: null,

	actions: {

		/**
			Action handler to sort columns by a passed column. Sets the &#x60;sortDirection&#x60;
			of the pass column to the appropriate value based on the &#x60;sortType&#x60;.
			@method actions.sort
			@param sortedColumn {nf-column}
		*/
		sort: function(sortedColumn) {
			sortedColumn.toggleSortDirection();
		},

		rowClick: function(row, group){
			this.sendAction(&#x27;rowAction&#x27;, row, group, this);
		},

		groupRowClick: function(group){
			this.sendAction(&#x27;groupRowAction&#x27;, group, this);
		},

		scrolled: function(e) {
			e.data = this;
			this.sendAction(&#x27;scrollAction&#x27;, e);
		},
	},
});


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
